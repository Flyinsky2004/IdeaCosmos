<script setup>
import { onMounted, reactive } from "vue";
import { MdPreview } from "md-editor-v3";
import "md-editor-v3/lib/preview.css";
import { useThemeStore } from "@/stores/theme";
import Loader from "@/components/loader.vue";
import { get, post } from "@/util/request";
import { message } from "ant-design-vue";
const themeStore = useThemeStore();
const chapter = JSON.parse(localStorage.getItem("chapter"));
onMounted(() => {
  fetchCurrentChapterVersion();
});
const fetchCurrentChapterVersion = () => {
  if (chapter.version_id === 0) return;
  get(
    "/api/project/getCurrentChapterVersion",
    {
      chapter_id: chapter.ID,
    },
    (messager, data) => {
      options.currentVersion = data;
    },
    (messager, data) => {
      message.warning(messager);
    },
    (messager, data) => {
      message.error(messager);
    }
  );
};
const options = reactive({
  historyVersions: [],
  currentVersion: {},
  isGenerating: false,
  generatedContent: "",
});

options.generatedContent = `# 第1章 AI浪潮的兴起\n\n## 1.1 时代的浪潮\n\n2025年，全球范围内人工智能（AI）和大语言模型（LLM）的热潮席卷而来，几乎每一个角落都能感受到这股技术风暴的冲击。从日常生活到工作学习，AI无处不在，渗透进社会的每一个细胞。大学生群体，作为这场变革的先锋，既是技术的热情拥抱者，也是未来不确定性的焦虑者。他们站在时代的浪尖上，既兴奋于技术的无限可能，又对未来的未知感到隐隐不安。\n\n李明是一名普通的大学生，主修文学，对戏剧有着浓厚的兴趣。他的生活原本平淡无奇，每天上课、读书、写作业，偶尔参加校园戏剧社的活动。然而，这一切在他偶然发现一款名为“创想无限”的AI生成内容应用后，发生了翻天覆地的变化。\n\n“创想无限”是一款集成AI生成剧本、小说等内容作品的Web应用，由一家中国互联网初创企业推出。这款应用凭借其强大的功能和便捷的操作，迅速在大学生群体中走红，成为他们创作和娱乐的新宠。李明第一次听说这款应用，是在一次校园戏剧社的排练中。\n\n## 1.2 偶然的发现\n\n那是一个普通的下午，李明和戏剧社的成员们正在为即将到来的校园戏剧节做准备。剧本的创作一直是戏剧社的难题，尤其是对于他们这些非专业的学生来说，写出一部既有深度又有趣味的剧本并不容易。社长王丽皱着眉头，翻看着手中的草稿，叹了口气：“我们这次的剧本还是不够出彩，观众可能会觉得无聊。”\n\n李明坐在一旁，心里也有些焦虑。他热爱戏剧，但创作剧本对他来说并不是一件轻松的事。就在大家一筹莫展的时候，张伟——李明的室友兼好友，突然推门走了进来。\n\n“嘿，你们在干嘛呢？”张伟手里拿着一杯咖啡，脸上带着轻松的笑容。\n\n“我们在讨论剧本，但进展不太顺利。”李明无奈地耸了耸肩。\n\n张伟挑了挑眉，走到李明身边坐下：“你们听说过‘创想无限’吗？最近挺火的，据说可以自动生成剧本、小说，甚至诗歌。”\n\n“自动生成剧本？”王丽抬起头，眼中闪过一丝好奇，“真的有那么神奇？”\n\n“当然！”张伟掏出手机，打开“创想无限”的应用界面，“你们看，只需要输入一些关键词，选择风格和长度，它就能在几秒钟内生成一个完整的剧本。”\n\n李明凑过去，看着张伟在手机上快速操作。屏幕上，一行行文字迅速生成，仿佛有一个看不见的作家在飞快地打字。几秒钟后，一个完整的剧本呈现在他们面前。\n\n“这……这也太快了吧？”李明瞪大了眼睛，难以置信地看着屏幕。\n\n“怎么样？要不要试试？”张伟笑着把手机递给李明。\n\n李明接过手机，犹豫了一下，输入了几个关键词：“校园、青春、友情、成长”。几秒钟后，一个关于大学生活的剧本出现在屏幕上。剧本的情节流畅，对话生动，甚至还有一些幽默的桥段。\n\n“这……这简直太棒了！”李明兴奋地抬起头，“我们可以直接用这个剧本！”\n\n王丽也凑过来看了看，眼中闪过一丝惊讶：“确实不错，比我们自己写的要好得多。”\n\n## 1.3 初尝甜头\n\n就这样，李明和戏剧社的成员们决定使用“创想无限”生成的剧本参加校园戏剧节。接下来的几天里，他们全身心投入到排练中。剧本的情节紧凑，对话幽默，演员们很快就进入了状态。李明负责导演和部分主演工作，他对这个剧本充满了信心。\n\n戏剧节当天，礼堂里座无虚席。李明站在后台，深吸了一口气，心里既紧张又兴奋。他知道，这次的剧本是他们迄今为止最好的作品，观众一定会喜欢。\n\n演出开始了。舞台上的灯光亮起，演员们走上台，开始了他们的表演。随着剧情的推进，观众们的笑声和掌声此起彼伏。李明站在后台，听着观众的反应，心里感到一阵满足。\n\n演出结束后，观众们起立鼓掌，掌声久久不息。李明和戏剧社的成员们走上台，向观众鞠躬致谢。王丽脸上洋溢着笑容，低声对李明说：“这次真的成功了！”\n\n李明点了点头，心里充满了成就感。他知道，这次的成功离不开“创想无限”的帮助。如果没有那个AI生成的剧本，他们可能还在为剧本的创作而苦恼。\n\n## 1.4 技术的诱惑\n\n演出结束后，李明回到宿舍，心情依然难以平静。他坐在桌前，打开电脑，再次登录了“创想无限”的应用界面。屏幕上，AI助手静静地等待着他的指令。\n\n“真是太神奇了……”李明喃喃自语，手指在键盘上轻轻敲击。他输入了几个新的关键词，几秒钟后，一个新的剧本出现在屏幕上。\n\n李明仔细阅读着剧本，心里感到一阵兴奋。这个剧本的情节更加复杂，人物形象也更加丰满。他甚至开始想象，如果把这个剧本搬上舞台，观众会有什么样的反应。\n\n“李明，你还在看那个应用？”张伟从浴室里走出来，擦着湿漉漉的头发。\n\n“是啊，这个AI真的太厉害了。”李明抬起头，眼中闪烁着兴奋的光芒，“我觉得我们可以用这个新剧本再排一部戏。”\n\n张伟笑了笑，走到李明身边坐下：“你这么快就上瘾了？”\n\n“你不觉得这很神奇吗？”李明指着屏幕，“只需要输入几个关键词，就能生成一个完整的剧本。这简直就像是有一个看不见的作家在帮我们创作。”\n\n张伟点了点头：“确实很神奇。不过，你有没有想过，这种便利背后可能隐藏着一些问题？”\n\n“问题？”李明皱了皱眉，“什么问题？”\n\n张伟耸了耸肩：“比如说，如果所有人都依赖AI生成内容，那人类的创造力会不会逐渐退化？还有，AI生成的内容真的能代表人类的真实情感吗？”\n\n李明沉默了一会儿，心里感到一阵不安。他之前并没有想过这些问题。AI生成的剧本确实很优秀，但它们真的能表达出人类的情感和思想吗？\n\n“我不知道……”李明低声说道，“但至少现在，它帮我们解决了创作上的难题。”\n\n张伟拍了拍李明的肩膀：“别想太多了，享受当下的成功吧。不过，以后我们可以多讨论一下AI的优缺点。”\n\n李明点了点头，心里却依然有些不安。他知道，张伟的话并不是没有道理。AI的便利确实让人上瘾，但这种依赖背后，可能隐藏着更大的问题。\n\n## 1.5 成功的背后\n\n接下来的几周里，李明和戏剧社的成员们继续使用“创想无限”生成的剧本进行排练。他们的演出越来越受欢迎，校园里甚至开始流传着“戏剧社的剧本都是AI写的”这样的传闻。\n\n李明听到这些传闻时，心里感到一阵复杂。他知道，这些传闻并不完全是假的。他们的剧本确实是由AI生成的，但观众们并不知道这一点。他们只是觉得剧本很有趣，演员的表演也很出色。\n\n“李明，你有没有觉得，我们有点太依赖AI了？”王丽在一次排练结束后，突然问道。\n\n李明愣了一下，抬头看着王丽：“你也有这种感觉？”\n\n王丽点了点头：“是啊，虽然AI生成的剧本确实很棒，但我总觉得少了点什么。我们以前自己写剧本的时候，虽然过程很艰难，但那种创作的乐趣是AI无法替代的。”\n\n李明沉默了一会儿，心里感到一阵共鸣。他也有同样的感觉。AI生成的剧本虽然优秀，但它们缺乏一种人类创作时的灵感和情感。那种在创作过程中不断思考、不断修改的乐趣，是AI无法提供的。\n\n“也许我们该试着回归传统创作方式。”李明低声说道。\n\n王丽点了点头：“我也这么觉得。不过，我们可以先完成这次的演出，然后再慢慢调整。”\n\n李明同意了。他知道，现在还不是完全放弃AI的时候。毕竟，他们的演出已经取得了巨大的成功，观众们也对他们充满了期待。\n\n## 1.6 反思的开始\n\n随着AI生成内容的普及，李明开始意识到这种便利背后可能隐藏的问题。他不再像之前那样盲目地依赖AI，而是开始思考AI对文化创作的影响。\n\n在一次文学课上，陈老师——李明的文学教授，提到了AI生成内容的话题。\n\n“同学们，你们有没有想过，AI生成的内容真的能代表人类的创造力吗？”陈老师站在讲台上，目光扫过教室里的每一个学生。\n\n李明坐在座位上，心里感到一阵紧张。他知道，陈老师对AI技术持保守态度，认为真正的创造力来自于人类自身。\n\n“AI可以模仿人类的语言和思维，但它无法真正理解人类的情感和思想。”陈老师继续说道，“真正的艺术创作，需要人类的情感和灵感，这是AI无法替代的。”\n\n李明低下头，心里感到一阵愧疚。他知道，自己之前过于依赖AI生成的剧本，忽略了人类创作的重要性。\n\n课后，李明主动找到陈老师，想和他讨论一下AI生成内容的问题。\n\n“陈老师，您刚才说的关于AI生成内容的话题，我觉得很有道理。”李明站在陈老师面前，语气诚恳。\n\n陈老师笑了笑，示意李明坐下：“你也有这种感觉？”\n\n李明点了点头：“是的，我之前一直依赖AI生成的剧本，但现在我开始意识到，这种便利背后可能隐藏着一些问题。”\n\n陈老师点了点头：“你能意识到这一点，很好。AI确实可以帮助我们解决一些技术上的难题，但它无法替代人类的创造力。真正的艺术创作，需要人类的情感和灵感。”\n\n李明沉默了一会儿，心里感到一阵共鸣。他知道，陈老师的话是对的。AI生成的剧本虽然优秀，但它们缺乏一种人类创作时的灵感和情感。\n\n“我决定以后不再完全依赖AI生成的剧本。”李明低声说道。\n\n陈老师笑了笑，拍了拍李明的肩膀：“很好，记住，真正的创造力来自于人类自身。AI只是一种工具，而不是替代品。”\n\n## 1.7 新的开始\n\n经过一系列的讨论和反思，李明逐渐看透了AI的本质。他意识到，AI只是一种工具，真正的创造力仍然来自于人类自身。他决定不再依赖AI生成内容，而是重新回归到传统创作方式中，结合AI的优势，创造出更具深度和个性的作品。\n\n在接下来的日子里，李明开始尝试自己创作剧本。虽然过程比使用AI生成剧本要艰难得多，但他感到了一种前所未有的满足感。他知道，这种创作的乐趣是AI无法替代的。\n\n与此同时，李明也和张伟、王丽等人讨论了AI的优缺点。他们一致认为，AI可以帮助他们解决一些技术上的难题，但真正的艺术创作仍然需要人类的情感和灵感。\n\n“我们可以把AI作为一种工具，而不是替代品。”张伟在一次讨论中说道，“这样，我们既能享受AI带来的便利，又能保持人类创作的独特性。”\n\n李明点了点头，心里感到一阵轻松。他知道，自己找到了一种平衡点。AI并不是敌人，而是一种可以帮助他们更好地创作的伙伴。\n\n## 1.8 人机共创\n\n在校园戏剧社的演出中，李明和他的朋友们展示了一部由人类与AI共同创作的剧本。这部剧本既保留了人类创作的情感和灵感，又利用了AI生成内容的优势，赢得了观众的热烈掌声。\n\n演出结束后，李明站在舞台上，看着台下欢呼的观众，心里感到一阵满足。他知道，这次的成功不仅仅是因为AI的帮助，更是因为他们找到了人类与AI结合的创作方式。\n\n“我们做到了！”王丽兴奋地拍了拍李明的肩膀。\n\n李明点了点头，脸上露出了笑容：“是啊，我们找到了平衡点。”\n\n张伟也走了过来，笑着说道：“看来，AI并不是敌人，而是我们的伙伴。”\n\n李明看着张伟，心里感到一阵温暖。他知道，这次的成功离不开朋友们的支持和帮助。他们一起探索了AI与人类创造力结合的可能性，找到了属于自己的创作方式。\n\n## 1.9 新的开始\n\n通过一系列的讨论和反思，李明和他的朋友们逐渐看透了AI的本质。他们意识到，AI只是一种工具，真正的创造力仍然来自于人类自身。他们决定不再依赖AI生成内容，而是结合AI的优势，推动文化创作向前发展。\n\n在接下来的日子里，李明和他的朋友们继续探索AI与人类创造力结合的可能性。他们创作出了更多优秀的作品，赢得了观众的认可和赞誉。\n\n李明知道，AI并不会取代人类文明，而是成为人类文明的一部分，推动其向前发展。他感到一种前所未有的信心和力量，准备迎接未来的挑战。\n\n“我们还有很多事情要做。”李明站在校园的操场上，看着远处的夕阳，心里充满了希望。\n\n他知道，这只是一个新的开始。`;
</script>

<template>
  {{ chapter }}
  <div class="h-full w-full grid grid-cols-[4fr,1fr] gap-2">
    <div
      class="border theme-border p-2 rounded-xl flex flex-col gap-2"
    >
      <div class="h-fit border theme-border p-4 rounded-xl flex flex-col gap-2">
        <span class="text-blue-500 font-bold text-xl">工具栏</span>
        <div class="w-full grid grid-cols-7 gap-2">
          <button class="color-mixed-button">应用该版本</button>
          <button class="basic-success-button">应用该版本</button>
          <button class="basic-info-button">应用该版本</button>
          <button class="basic-success-button">应用该版本</button>
        </div>
      </div>
      <div class="flex flex-grow flex-col dark:bg-indigo-950/10 border theme-border rounded-xl">
        <span class="text-blue-500 font-bold text-xl mt-4 ml-4">当前版本</span>
        <MdPreview
          v-if="options.generatedContent !== ''"
          style="background: transparent"
          :theme="themeStore.currentTheme"
          editorId="preview-only"
          :modelValue="options.generatedContent"
        />
        <div
          class="mx-auto my-auto"
          v-if="chapter.version_id === 0 && !options.isGenerating"
        >
          <span class="text-gray-600">此篇章还没有内容哦</span>
        </div>
        <MdPreview
          v-else-if="!options.isGenerating"
          style="background: transparent"
          :theme="themeStore.currentTheme"
          editorId="preview-only"
          :modelValue="testData"
        />
        <div
          class="mx-auto my-auto flex place-items-center flex-col gap-2"
          v-else
        >
          <Loader />
          <span class="font-bold">剧匠AI思考中...</span>
        </div>
      </div>
    </div>
    <div class="border theme-border p-2 rounded-xl flex flex-col">
      <h1 class="text-3xl text-blue-500">历史版本</h1>
      <div class="" v-if="options.historyVersions.length === 0">
        <span class="text-gray-600">还没有历史版本哦</span>
      </div>
    </div>
  </div>
</template>

<style scoped>
</style>
